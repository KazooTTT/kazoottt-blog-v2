---
title: ollama + excel处理器开发总结
date: 2025-01-07
author: KazooTTT
type: Post
status: Published
tags:
  - ollama
  - excel
  - 处理器
  - 独立开发
finished: true
published: true
category: 随笔
slug: ollama-excel-processor-development-summary
description: 最近帮朋友写了一个 ollama + excel 处理器，写完后发现类似于飞书多维表格的 ai 功能。在开发和沟通过程中有一些感受。
toAstro: true
date_created: 2025-01-07T23:09:15+08:00
date_modified: 2025-01-22T13:39:22+08:00
---

最近帮朋友写了一个 ollama + excel 处理器，写完后发现类似于飞书多维表格的 ai 功能。在开发和沟通过程中有一些感受。

## 首先是开发与设计

写的时候凭自己的直觉设计的交互逻辑，没有参考任何其他产品，后来发现其实写的过于灵活会加重用户学习负担和降低模型回复准确度。

我这边的逻辑是上传 excel，然后用提示词 +excel 列变量 + 配置输出列这样的拼接方式来生成提示词。

这样遇到的问题是用 excel 列变量的时候，点击 excel 列是插入到光标的位置，有的用户并不会理解或者注意这个逻辑，所以会出现插到某些连续句子中间导致语义被破坏的情况。

飞书多维表格的做法是，限制提示词的自由发挥，严格按照表单填写来生成最终提示词，并且真实的提示词是不暴露给用户的。步骤：选择输出的列，选择输入的列，输入要输出的列的需求，输入例子。

下图是飞书多维表格的界面截图：

![IMG-AB32ADD047445DF08A90ECA3417190E2](https://pictures.kazoottt.top/2025/20250107-ab32add047445df08a90eca3417190e2.png)

用这种方法把提示词的 few shots 写法实现了，所以它的操作逻辑简化了很多的。

回头想想普通用户并不需要那么自由的提示词输入，是我做的时候太想当然，把它做成了一个 llm chat ui 的模式。

## 其次是沟通

做完项目直接发了安装包给朋友，没有写使用说明，是在她使用过程中一步步去教她的，所以出现了很多碎片化的沟通。并且在此之前她并没有大模型相关的使用经验，所以一些我个人认为的共识没有达成，多聊了一些后才发现是哪里出了问题。

导致问题的原因主要有两个，一个是之前提到的我的设计存在问题，加重了用户负担。另一个就是没有做用户引导和教学。

## 总结

所以总结来说，'fake it till you make it' 或者 " 先做一坨垃圾出来 " 没有什么问题，但后续真的要把一个东西做好还是应该有一定的调研和思考和设计，以及要意识到通过引导和沟通与他人达成共识的重要性。
