---
title: 深拷贝与浅拷贝
date: 2023-10-19T00:00:00.000Z
author: KazooTTT
tags:
  - 深拷贝
  - 浅拷贝
  - JavaScript
  - JavaScript基础
toAstro: true
slug: deep-copy-vs-shallow-copy
description: >-
  深拷贝与浅拷贝是编程中处理数据拷贝的两种方式。浅拷贝中，原始变量和新变量共享相同的内存地址，一个变量的变化会影响其他变量。而深拷贝则创建一个新变量，其值与原始变量相同但内存地址不同，修改一个变量不会影响另一个。实现深拷贝的方法包括使用第三方库如Lodash的`_.cloneDeep()`或Ramda的`clone`，使用JSON的`stringify`和`parse`组合，但这种方法有局限性，如容易报错和丢失值。此外，也可以自己编写深拷贝函数，参考深度优先遍历的原理。
date_created: 2025-01-04T03:34:08.000Z
date_modified: 2025-02-19T03:44:08.000Z
---

# 深拷贝与浅拷贝

## 概念

什么是浅拷贝  
原始和新的变量指向的内存地址是一样的，任意一个发生了变化，其他的也跟着变化。

什么是深拷贝  
创建一个新的变量，变量的值与之前变量的值一样，但是地址不一样，修改后不会影响另一个值。（改旧的不影响新的，改新的不影响旧的。）

## 如何实现深拷贝

### 方法一 用第三方库

[Lodash \_.cloneDeep() Method](<https://www.geeksforgeeks.org/lodash-_-clonedeep-method/>)  
[Ramda-clone](<https://ramdajs.com/docs/#clone>)

社区还有很多其他的，上面是比较经典常用的。

### 方法二 Json 方法，stringify + Parse 组合使用

先用 stringfy 把 object 压成 string,然后用 parse 解析

```javascript
JSON.parse(JSON.stringify(obj1))
```

局限性比较大，**不建议用**。

具体原因：

日期转成字符串，用 parse 再转回去需要自己做处理  
比较脆弱，容易报错，要做异常处理  
特殊的数值会转成 null，比如 NaN Infinity  
等等

总结来说就是：

容易报错  
容易丢失值

### 方法三 尝试自己实现

参考深拷贝的定义自己实现就可以了。关键词深度优先遍历。

也可以看看 [lodash 的源码](<https://github.com/lodash/lodash/blob/main/src/cloneDeep.ts>)
